## Sequence Alignment
### CLUSTALW

An algorithm used for ***Global Alignments***, but which is considered less effective than others.

![alt text](<Screenshot 2024-10-22 at 09.26.40.png>)

The tool will calculate the distance matrix between sequences, which distance expresses the **relative-time distance** of **speciation** which led to these sequences ***differing through substitutions*** etc.

Using ***Neighbour-Joining*** it will create a ==**guide tree**==, to later obtain the multiple alignment; this tree does not represent phylogenetic relationship directly.

Neighbour-Joining:
: Can be performed by the ***UPGMA method (==Unweighted== Pair Groups with Arithmetic Mean)*** to calculate distance, if we are to **assume that branches were created at the same time**; ![alt text](<Screenshot 2024-10-22 at 09.34.30.png>) Where: n is the "number of sequences" (to account for groups) 
Else, ***WPGMA method (==Weighted== Pair Groups with Arithmetic Mean)***: ![alt text](<Screenshot 2024-10-22 at 09.37.04.png>)

### Calculating UPGMA: Worked Example.

![alt text](<Screenshot 2024-11-02 at 17.29.56.png>)

To more easily read the table and work on the calculations, the sequences can be renamed to A, B, C, D and E.

| Distance Matrix | A | B | C | D | E |
| :------ | :------ | :------ | :------ | :------ | :------ |
| A | \- | 8 | 15 | 38 | 30 |
| B |  | \- | ==**7**== | 45 | 40 |
| C |  |  | \- | 50 | 47 |
| D |  |  |  | \- | 20 |
| E |  |  |  |  | \- |

Now, we will first identify the smallest value within the distance matrix denoted above; this distance matrix is generated by CLUSTALW through sequence alignment in phylogenetic inference.

As the smallest distance represents the **nearest phylogenetic distance between two sequences**, they should be **grouped together**, as such:

![alt text](<Screenshot 2024-11-02 at 19.55.15.png>)

The lengths displayed at the branches result from the total distance (7), ***divided by the number of branches***:

$7 / 2 = 3.5$

Following the grouping/**rooting** of these two sequences, let's look at the rest; this involves recreating a table and recalculating distances with:

![alt text](<Screenshot 2024-10-22 at 09.37.04.png>)

| Distance Matrix | A | B, C | D | E |
| :---: | :---: | :---: | :---: | :---: |
| A | \- | ==**11.5**== | 38 | 30 |
| B, C |  | \- | 47.5 | 43.5 |
| D |  |  | \- | 20 |
| E |  |  |  | \- |

From these calculations we can see that **A and BuC share a common ancestor**, they should therefore be *anchored together*, similar to this:

![alt text](<Screenshot 2024-11-02 at 18.41.20.png>)

Having done so, we have to continue the calculations to root all leaves together; the calculations don't change much from before.

Consider that since A is an outgroup, and B and C belong to the same clade, we have to approach it differently;

* BuC were the **first pair of sequences** to be calculated, they will therefore be ***amplified*** in the subsequent calculations.
* Of course, now you have to ***divide by three***, as you amplified $d(BC, D)$ and you also have $d(D, A)$. 

$ d(ABC, D) = (2*d(BC, D) + d(A, D)) / 3 <=> $
$ (2 * 47.5 + 38) / 3 $ = ==***44.33***==

| Distance Matrix | A, B, C | D | E |
| :---: | :---: | :---: | :---: |
| A, B, C | \- | 44.33 | 39 |
| D |  | \- | ==**20**== |
| E |  |  | \- |

Now we have **another clade**, involving both sequences ***D and E***.

Repeat the process again, but remember, ***no amplification***:

$ d(ABC, DE) = (ABC, E) + (ABC, D) / 2 <=>$
$ (39 + 44.33) / 2 $ = ==***41.665***==

| Distance Matrix | B, C, A | D, E |
| :---: | :---: | :---: | 
| B, C, A | \- | 41.67 |
| D, E |  | \- | 

These calculations should lead you to something like this:

![alt text](<Screenshot 2024-11-02 at 19.33.14.png>)

The final value obtained is the ***origin of the tree***, the original root to which ***all clades should be rooted to***.

